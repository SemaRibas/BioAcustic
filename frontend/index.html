<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê∏ BioAcustic - Classificador de Anf√≠bios</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Design System -->
    <link rel="stylesheet" href="./css/design-system.css">
    
    <!-- TensorFlow.js -->
    <!-- Adicionando coment√°rio sobre o CDN: Para produ√ß√£o, considere hospedar localmente ou usar um bundler -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-500) 50%, var(--secondary-500) 100%);
        }
        
        .wave-animation {
            animation: wave 2s infinite ease-in-out;
        }
        
        @keyframes wave {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        
        #dropZone:hover {
            border-color: var(--primary-500) !important;
            background: var(--primary-50) !important;
        }
        
        #dropZone.drag-over {
            border-color: var(--primary-600) !important;
            background: var(--primary-100) !important;
            border-style: solid !important;
        }
        
        #analyzeBtn:hover:not(:disabled) {
            transform: scale(1.03) !important;
            box-shadow: var(--shadow-xl) !important;
        }

        /* Adicionando sombra ao texto do header para melhor legibilidade */
        .header-text-shadow {
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body style="background: var(--gray-50); margin: 0; padding: 0;">
    
    <!-- Header -->
    <header class="gradient-bg" style="padding: var(--space-3xl) var(--space-xl); color: white; box-shadow: var(--shadow-lg);">
        <div class="container">
            <div class="flex items-center justify-between" style="flex-wrap: wrap; gap: var(--space-lg);">
                <div class="flex items-center gap-md">
                    <div style="font-size: 3rem;" class="wave-animation">üê∏</div>
                    <div>
                        <h1 style="font-size: 2rem; font-weight: 800; margin: 0;" class="header-text-shadow">BioAcustic</h1>
                        <p style="font-size: 0.875rem; opacity: 0.95; margin: 0;" class="header-text-shadow">Classificador de Vocaliza√ß√µes de Anf√≠bios com IA</p>
                    </div>
                </div>
                <div class="flex items-center gap-md">
                    <a href="train.html" class="btn btn-lg" style="background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); color: white; border: 1px solid rgba(255,255,255,0.3);">
                        üéì Treinar Modelo
                    </a>
                    <div id="modelStatus" class="badge" style="background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); color: white; border: 1px solid rgba(255,255,255,0.3); padding: var(--space-sm) var(--space-md);">
                        <span class="spinner"></span> Carregando...
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container" style="padding-top: var(--space-2xl); padding-bottom: var(--space-2xl);">
        
        <!-- REMOVIDO: O statusAlert foi removido. js/ui.js agora cria notifica√ß√µes dinamicamente -->
        
        <!-- Upload Section -->
        <section class="card fade-in">
            <div class="card-header">
                <h2 style="font-size: 1.5rem; font-weight: 700; margin: 0; display: flex; align-items: center; gap: var(--space-sm);">
                    üì§ Enviar √Åudio
                </h2>
            </div>
            <div class="card-body">
                <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-xl);">
                    <!-- File Upload -->
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-sm);">
                            üìÇ Selecionar arquivo
                        </label>
                        <div id="dropZone" style="border: 2px dashed var(--gray-300); border-radius: var(--radius-xl); padding: var(--space-2xl); text-align: center; cursor: pointer; transition: all var(--transition-base); background: white;">
                            <input type="file" id="audioUpload" accept="audio/*" style="display: none;">
                            <label for="audioUpload" style="cursor: pointer; display: block;">
                                <div style="font-size: 3rem; margin-bottom: var(--space-md);">üéµ</div>
                                <p style="color: var(--gray-700); font-weight: 600; margin-bottom: var(--space-xs);">Clique ou arraste um arquivo</p>
                                <p style="font-size: 0.875rem; color: var(--gray-500);">MP3, WAV, FLAC (m√°x. 10MB)</p>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Record Audio -->
                    <div>
                        <label style="display: block; font-size: 0.875rem; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-sm);">
                            üé§ Gravar ao vivo
                        </label>
                        <div style="border: 1px solid var(--gray-200); border-radius: var(--radius-xl); padding: var(--space-2xl); text-align: center; background: white; min-height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: var(--shadow-sm);">
                            <div style="font-size: 3rem; margin-bottom: var(--space-md);">üéôÔ∏è</div>
                            <button id="recordBtn" class="btn" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border-radius: var(--radius-full); box-shadow: var(--shadow-md);">
                                ‚è∫ Iniciar Grava√ß√£o
                            </button>
                            <p id="recordingStatus" style="font-size: 0.875rem; color: var(--gray-500); margin-top: var(--space-md);"></p>
                        </div>
                    </div>
                </div>
                
                <!-- Audio Player -->
                <div id="audioPlayerContainer" class="hidden" style="margin-top: var(--space-xl);">
                    <label style="display: block; font-size: 0.875rem; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-sm);">
                        ‚ñ∂Ô∏è Player de √Åudio
                    </label>
                    <div style="background: var(--gray-50); border-radius: var(--radius-lg); padding: var(--space-lg); border: 1px solid var(--gray-200);">
                        <audio id="audioPlayer" controls style="width: 100%; margin-bottom: var(--space-md);"></audio>
                        <div id="waveform" style="height: 120px; background: linear-gradient(135deg, var(--gray-900), var(--gray-800)); border-radius: var(--radius-md);"></div>
                    </div>
                </div>
                
                <!-- Analyze Button -->
                <div style="text-align: center; margin-top: var(--space-xl);">
                    <button id="analyzeBtn" class="btn btn-primary btn-lg" disabled style="box-shadow: var(--shadow-lg); transform: scale(1); transition: transform var(--transition-base), box-shadow var(--transition-base);">
                        üß† Analisar Vocaliza√ß√£o
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay hidden">
            <div style="background: white; padding: var(--space-3xl); border-radius: var(--radius-2xl); box-shadow: var(--shadow-2xl); text-align: center; min-width: 320px; animation: scaleIn 0.3s ease-out;">
                <div style="width: 80px; height: 80px; margin: 0 auto var(--space-lg); background: linear-gradient(135deg, var(--primary-500), var(--primary-400)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; animation: pulse 2s ease-in-out infinite;">üß†</div>
                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-sm);">Processando √Åudio...</h3>
                <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: var(--space-lg);">Gerando espectrograma e executando infer√™ncia</p>
                <div class="progress">
                    <div id="progressBar" class="progress-bar" style="width: 0%"></div>
                </div>
                <p id="progressText" style="font-size: 0.75rem; color: var(--gray-500); margin-top: var(--space-sm);">0%</p>
            </div>
        </div>
        
        <!-- Results Section -->
        <section id="resultsSection" class="hidden" style="margin-top: var(--space-2xl);">
            <div class="card" style="margin-bottom: var(--space-xl);">
                <div class="card-header">
                    <h2 style="font-size: 1.5rem; font-weight: 700; margin: 0; display: flex; align-items: center; gap: var(--space-sm);">
                        üìä Resultados da Classifica√ß√£o
                    </h2>
                </div>
                <div class="card-body">
                    <div id="resultsContainer" style="margin-bottom: var(--space-xl);">
                        <!-- Resultados ser√£o inseridos dinamicamente -->
                    </div>
                    
                    <!-- Spectrogram Visualization -->
                    <div>
                        <h3 style="font-size: 1rem; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-md);">
                            üìà Mel-Espectrograma
                        </h3>
                        <div style="background: linear-gradient(135deg, var(--gray-900), var(--gray-800)); border-radius: var(--radius-xl); padding: var(--space-xl); border: 1px solid var(--gray-700);">
                            <canvas id="spectrogramCanvas" style="width: 100%; height: 200px; border-radius: var(--radius-lg);"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Species Info Card -->
            <div id="speciesInfoCard" class="hidden" style="background: linear-gradient(135deg, var(--primary-50), var(--secondary-50)); border-radius: var(--radius-xl); padding: var(--space-xl); border: 1px solid var(--primary-200); box-shadow: var(--shadow-md);">
                <h3 style="font-size: 1.125rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-md); display: flex; align-items: center; gap: var(--space-sm);">
                    ‚ÑπÔ∏è Informa√ß√µes da Esp√©cie
                </h3>
                <div id="speciesInfoContent">
                    <p style="color: var(--gray-600);">Clique em um resultado acima para ver os detalhes da esp√©cie</p>
                </div>
            </div>
        </section>
        
    </main>

    <!-- Footer -->
    <footer style="background: var(--gray-900); color: white; padding: var(--space-2xl) 0; margin-top: var(--space-3xl);">
        <div class="container text-center">
            <p style="font-size: 0.875rem; margin-bottom: var(--space-sm);">
                üß¨ Desenvolvido com TensorFlow.js e Deep Learning
            </p>
            <p style="font-size: 0.75rem; color: var(--gray-400);">
                Projeto BioAcustic ¬© 2025 | Para fins educacionais e cient√≠ficos
            </p>
        </div>
    </footer>

    <!-- O container de notifica√ß√£o ser√° injetado aqui pelo ui.js -->
    
    <!-- Scripts -->
    <script type="module" src="./js/app.js"></script>

</body>
</html>
